2026-02-21 17:27:34,201 - INFO - Starting build_unified_training_table in SUPERVISED mode
2026-02-21 17:27:34,201 - INFO - ============================================================
2026-02-21 17:27:34,201 - INFO - Building Unified Training Table
2026-02-21 17:27:34,201 - INFO - ============================================================
2026-02-21 17:27:35,052 - INFO - Loaded 949,642 college feature rows (all splits)
2026-02-21 17:27:35,410 - INFO - Loaded team-strength rows: 10,759
2026-02-21 17:27:35,421 - INFO - Loaded 118,872 derived box stat rows
2026-02-21 17:27:42,587 - INFO - Loaded API event games candidate rows: 118,872
2026-02-21 17:27:42,599 - INFO - Loaded enhanced activity rows: 114,470
2026-02-21 17:27:52,621 - INFO - Loaded mapped historical exposure backfill rows: 66,871
2026-02-21 17:27:58,095 - WARNING - Clipping 105 historical text-games rows above 45 games
2026-02-21 17:27:58,095 - INFO - Loaded historical text games backfill rows: 45,084
2026-02-21 17:27:58,115 - INFO - Loaded 28,770 college impact stack rows
2026-02-21 17:27:58,125 - INFO - Loaded 114,470 college pathway context rows
2026-02-21 17:27:58,185 - INFO - Merged derived box stats. Rows: 114470 -> 114470
2026-02-21 17:27:58,212 - INFO - Merged API event games candidate. Rows: 114470 -> 114470
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1585: FutureWarning: errors='ignore' is deprecated and will raise in a future version. Use to_numeric without passing `errors` and catch exceptions explicitly instead
  college_features[c] = pd.to_numeric(sy, errors="ignore").combine_first(
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1586: FutureWarning: errors='ignore' is deprecated and will raise in a future version. Use to_numeric without passing `errors` and catch exceptions explicitly instead
  pd.to_numeric(sx, errors="ignore")
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1585: FutureWarning: errors='ignore' is deprecated and will raise in a future version. Use to_numeric without passing `errors` and catch exceptions explicitly instead
  college_features[c] = pd.to_numeric(sy, errors="ignore").combine_first(
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1586: FutureWarning: errors='ignore' is deprecated and will raise in a future version. Use to_numeric without passing `errors` and catch exceptions explicitly instead
  pd.to_numeric(sx, errors="ignore")
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1585: FutureWarning: errors='ignore' is deprecated and will raise in a future version. Use to_numeric without passing `errors` and catch exceptions explicitly instead
  college_features[c] = pd.to_numeric(sy, errors="ignore").combine_first(
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1586: FutureWarning: errors='ignore' is deprecated and will raise in a future version. Use to_numeric without passing `errors` and catch exceptions explicitly instead
  pd.to_numeric(sx, errors="ignore")
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1585: FutureWarning: errors='ignore' is deprecated and will raise in a future version. Use to_numeric without passing `errors` and catch exceptions explicitly instead
  college_features[c] = pd.to_numeric(sy, errors="ignore").combine_first(
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1586: FutureWarning: errors='ignore' is deprecated and will raise in a future version. Use to_numeric without passing `errors` and catch exceptions explicitly instead
  pd.to_numeric(sx, errors="ignore")
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1585: FutureWarning: errors='ignore' is deprecated and will raise in a future version. Use to_numeric without passing `errors` and catch exceptions explicitly instead
  college_features[c] = pd.to_numeric(sy, errors="ignore").combine_first(
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1586: FutureWarning: errors='ignore' is deprecated and will raise in a future version. Use to_numeric without passing `errors` and catch exceptions explicitly instead
  pd.to_numeric(sx, errors="ignore")
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1585: FutureWarning: errors='ignore' is deprecated and will raise in a future version. Use to_numeric without passing `errors` and catch exceptions explicitly instead
  college_features[c] = pd.to_numeric(sy, errors="ignore").combine_first(
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1586: FutureWarning: errors='ignore' is deprecated and will raise in a future version. Use to_numeric without passing `errors` and catch exceptions explicitly instead
  pd.to_numeric(sx, errors="ignore")
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1585: FutureWarning: errors='ignore' is deprecated and will raise in a future version. Use to_numeric without passing `errors` and catch exceptions explicitly instead
  college_features[c] = pd.to_numeric(sy, errors="ignore").combine_first(
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1586: FutureWarning: errors='ignore' is deprecated and will raise in a future version. Use to_numeric without passing `errors` and catch exceptions explicitly instead
  pd.to_numeric(sx, errors="ignore")
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1585: FutureWarning: errors='ignore' is deprecated and will raise in a future version. Use to_numeric without passing `errors` and catch exceptions explicitly instead
  college_features[c] = pd.to_numeric(sy, errors="ignore").combine_first(
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1586: FutureWarning: errors='ignore' is deprecated and will raise in a future version. Use to_numeric without passing `errors` and catch exceptions explicitly instead
  pd.to_numeric(sx, errors="ignore")
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1585: FutureWarning: errors='ignore' is deprecated and will raise in a future version. Use to_numeric without passing `errors` and catch exceptions explicitly instead
  college_features[c] = pd.to_numeric(sy, errors="ignore").combine_first(
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1586: FutureWarning: errors='ignore' is deprecated and will raise in a future version. Use to_numeric without passing `errors` and catch exceptions explicitly instead
  pd.to_numeric(sx, errors="ignore")
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1585: FutureWarning: The behavior of array concatenation with empty entries is deprecated. In a future version, this will no longer exclude empty items when determining the result dtype. To retain the old behavior, exclude the empty entries before the concat operation.
  college_features[c] = pd.to_numeric(sy, errors="ignore").combine_first(
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1585: FutureWarning: errors='ignore' is deprecated and will raise in a future version. Use to_numeric without passing `errors` and catch exceptions explicitly instead
  college_features[c] = pd.to_numeric(sy, errors="ignore").combine_first(
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1586: FutureWarning: errors='ignore' is deprecated and will raise in a future version. Use to_numeric without passing `errors` and catch exceptions explicitly instead
  pd.to_numeric(sx, errors="ignore")
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1585: FutureWarning: The behavior of array concatenation with empty entries is deprecated. In a future version, this will no longer exclude empty items when determining the result dtype. To retain the old behavior, exclude the empty entries before the concat operation.
  college_features[c] = pd.to_numeric(sy, errors="ignore").combine_first(
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1585: FutureWarning: errors='ignore' is deprecated and will raise in a future version. Use to_numeric without passing `errors` and catch exceptions explicitly instead
  college_features[c] = pd.to_numeric(sy, errors="ignore").combine_first(
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1586: FutureWarning: errors='ignore' is deprecated and will raise in a future version. Use to_numeric without passing `errors` and catch exceptions explicitly instead
  pd.to_numeric(sx, errors="ignore")
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1585: FutureWarning: The behavior of array concatenation with empty entries is deprecated. In a future version, this will no longer exclude empty items when determining the result dtype. To retain the old behavior, exclude the empty entries before the concat operation.
  college_features[c] = pd.to_numeric(sy, errors="ignore").combine_first(
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1585: FutureWarning: errors='ignore' is deprecated and will raise in a future version. Use to_numeric without passing `errors` and catch exceptions explicitly instead
  college_features[c] = pd.to_numeric(sy, errors="ignore").combine_first(
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1586: FutureWarning: errors='ignore' is deprecated and will raise in a future version. Use to_numeric without passing `errors` and catch exceptions explicitly instead
  pd.to_numeric(sx, errors="ignore")
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1585: FutureWarning: The behavior of array concatenation with empty entries is deprecated. In a future version, this will no longer exclude empty items when determining the result dtype. To retain the old behavior, exclude the empty entries before the concat operation.
  college_features[c] = pd.to_numeric(sy, errors="ignore").combine_first(
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1585: FutureWarning: errors='ignore' is deprecated and will raise in a future version. Use to_numeric without passing `errors` and catch exceptions explicitly instead
  college_features[c] = pd.to_numeric(sy, errors="ignore").combine_first(
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1586: FutureWarning: errors='ignore' is deprecated and will raise in a future version. Use to_numeric without passing `errors` and catch exceptions explicitly instead
  pd.to_numeric(sx, errors="ignore")
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:1585: FutureWarning: The behavior of array concatenation with empty entries is deprecated. In a future version, this will no longer exclude empty items when determining the result dtype. To retain the old behavior, exclude the empty entries before the concat operation.
  college_features[c] = pd.to_numeric(sy, errors="ignore").combine_first(
2026-02-21 17:27:58,467 - INFO - Merged enhanced activity proxies on ['athlete_id', 'season', 'split_id']. Rows: 114470 -> 114470
2026-02-21 17:27:58,522 - INFO - PAOLO TRACE POST-EXPOSURE: games_played=[39.0]
2026-02-21 17:27:58,522 - INFO - Merged historical exposure backfill. Rows: 114470 -> 114470
2026-02-21 17:27:58,552 - INFO - PAOLO TRACE POST-HIST: games_played=[39.0]
2026-02-21 17:27:58,552 - INFO - Merged historical text games backfill. Rows: 114470 -> 114470
2026-02-21 17:28:09,251 - INFO - Loaded 59,078 career feature rows
2026-02-21 17:28:09,487 - INFO - Loaded 59,078 trajectory feature rows
2026-02-21 17:28:09,492 - INFO - Loaded 59,078 college dev-rate rows
2026-02-21 17:28:10,105 - INFO - Loaded transfer summary rows: 7,987
2026-02-21 17:28:10,107 - INFO - Loaded canonical college physicals rows: 7,524
2026-02-21 17:28:10,109 - INFO - Loaded college physical trajectory rows: 7,524
2026-02-21 17:28:10,110 - INFO - Loaded 1,218 crosswalk entries
2026-02-21 17:28:10,112 - INFO - Loaded 2,461 NBA dimension rows
2026-02-21 17:28:10,123 - INFO - Loaded NBA ws bridge rows: 2,223
2026-02-21 17:28:10,148 - INFO - Loaded recruiting physicals rows: 7,897
2026-02-21 17:28:10,150 - INFO - Loaded 2,239 peak RAPM targets
2026-02-21 17:28:10,154 - INFO - Loaded 2,461 year-1 EPM targets
2026-02-21 17:28:10,157 - INFO - Loaded 2,025 peak/rolling EPM targets
2026-02-21 17:28:10,159 - INFO - Loaded 1,114 gap targets
2026-02-21 17:28:10,161 - INFO - Loaded 2,461 development-rate targets
2026-02-21 17:28:10,447 - INFO - Extracted 59,078 final college seasons
2026-02-21 17:28:10,456 - INFO - PAOLO TRACE POST-AGGREGATOR: college_games_played=[39.0] / games_played=MISSING
2026-02-21 17:28:10,463 - INFO -   Added leverage-rate features to final season frame
2026-02-21 17:28:10,581 - INFO -   Applied era + team normalization on full population (59,078 rows, 9 derived cols)
2026-02-21 17:28:10,581 - INFO - Applying data surface grain for mode: supervised
2026-02-21 17:28:10,590 - INFO - Integrating Combine Athleticism Signals...
2026-02-21 17:28:10,602 - INFO -   Combine integration complete from fact_player_combine_measurements.parquet/fact_player_combine_imputed.parquet. Measured rows matching: 903
2026-02-21 17:28:10,607 - INFO -   Added canonical college physicals by season
2026-02-21 17:28:10,610 - INFO -   Added college physical trajectory features
2026-02-21 17:28:10,611 - INFO -   Added team-strength/SRS features
2026-02-21 17:28:10,687 - INFO -   Added college impact stack features (dual-season): 43
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:2046: FutureWarning: The behavior of array concatenation with empty entries is deprecated. In a future version, this will no longer exclude empty items when determining the result dtype. To retain the old behavior, exclude the empty entries before the concat operation.
  df[c] = base.combine_first(alt)
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:2046: FutureWarning: The behavior of array concatenation with empty entries is deprecated. In a future version, this will no longer exclude empty items when determining the result dtype. To retain the old behavior, exclude the empty entries before the concat operation.
  df[c] = base.combine_first(alt)
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:2085: FutureWarning: The behavior of array concatenation with empty entries is deprecated. In a future version, this will no longer exclude empty items when determining the result dtype. To retain the old behavior, exclude the empty entries before the concat operation.
  df[c] = base.combine_first(alt)
/Users/akashc/my-trankcopy/ml model/nba_scripts/build_unified_training_table.py:2085: FutureWarning: The behavior of array concatenation with empty entries is deprecated. In a future version, this will no longer exclude empty items when determining the result dtype. To retain the old behavior, exclude the empty entries before the concat operation.
  df[c] = base.combine_first(alt)
2026-02-21 17:28:11,146 - INFO -   Added college pathway context features (dual-season): 30
2026-02-21 17:28:11,157 - INFO -   Added college dev-rate features: 17
2026-02-21 17:28:11,159 - INFO -   Added transfer summary features: 12
2026-02-21 17:28:11,208 - INFO -   Added 44 trajectory features
2026-02-21 17:28:11,213 - WARNING - Supervised Mode: Dropped 136 duplicate nba_id rows.
2026-02-21 17:28:11,224 - INFO - Applied cohort filter draft_year_proxy >= 2011: kept 1076 / 1218 (dropped 142)
2026-02-21 17:28:11,226 - INFO - Joined dataset: 1,076 rows
2026-02-21 17:28:11,238 - INFO - After target filter (min=1): 1,076 rows
2026-02-21 17:28:11,238 - INFO - 
========================================
2026-02-21 17:28:11,238 - INFO - COVERAGE STATISTICS
2026-02-21 17:28:11,238 - INFO - ========================================
2026-02-21 17:28:11,238 - INFO - Total rows: 1,076
2026-02-21 17:28:11,238 - INFO -   y_peak_ovr: 451 (41.9%)
2026-02-21 17:28:11,238 - INFO -   gap_ts_legacy: 802 (74.5%)
2026-02-21 17:28:11,238 - INFO -   year1_epm_tot: 822 (76.4%)
2026-02-21 17:28:11,238 - INFO -   y_peak_epm_3y: 703 (65.3%)
2026-02-21 17:28:11,238 - INFO -   year1_epm_off: 822 (76.4%)
2026-02-21 17:28:11,238 - INFO -   year1_epm_def: 822 (76.4%)
2026-02-21 17:28:11,239 - INFO -   dev_rate_y1_y3_mean: 1,076 (100.0%)
2026-02-21 17:28:11,239 - INFO -   made_nba: 1,076 (100.0%)
2026-02-21 17:28:11,239 - INFO -   dev_rate_quality_weight: 1,076 (100.0%)
2026-02-21 17:28:11,239 - INFO -   dev_rate_y1_y3_sd: 1,076 (100.0%)
2026-02-21 17:28:11,239 - INFO -   college_dev_quality_weight: 838 (77.9%)
2026-02-21 17:28:11,239 - INFO -   college_dev_p50: 838 (77.9%)
2026-02-21 17:28:11,239 - INFO -   has_impact_raw: 23.7%
2026-02-21 17:28:11,239 - INFO -   has_impact_stint: 23.7%
2026-02-21 17:28:11,239 - INFO -   has_impact_ripm: 23.7%
2026-02-21 17:28:11,239 - INFO -   impact_reliability_weight: 255 (23.7%)
2026-02-21 17:28:11,239 - INFO -   has_transfer_context: 160 (14.9%)
2026-02-21 17:28:11,239 - INFO -   transfer_event_count: 160 (14.9%)
2026-02-21 17:28:11,239 - INFO -   transfer_max_shock: 160 (14.9%)
2026-02-21 17:28:11,239 - INFO -   has_spatial_data: 416 (38.7%)
2026-02-21 17:28:11,239 - INFO - 
Season distribution:
2026-02-21 17:28:11,240 - INFO -   2010: 9
2026-02-21 17:28:11,240 - INFO -   2011: 63
2026-02-21 17:28:11,240 - INFO -   2012: 66
2026-02-21 17:28:11,240 - INFO -   2013: 56
2026-02-21 17:28:11,240 - INFO -   2014: 67
2026-02-21 17:28:11,240 - INFO -   2015: 57
2026-02-21 17:28:11,240 - INFO -   2016: 82
2026-02-21 17:28:11,240 - INFO -   2017: 93
2026-02-21 17:28:11,240 - INFO -   2018: 89
2026-02-21 17:28:11,240 - INFO -   2019: 96
2026-02-21 17:28:11,240 - INFO -   2020: 86
2026-02-21 17:28:11,240 - INFO -   2021: 85
2026-02-21 17:28:11,240 - INFO -   2022: 81
2026-02-21 17:28:11,240 - INFO -   2023: 75
2026-02-21 17:28:11,240 - INFO -   2024: 70
2026-02-21 17:28:11,240 - INFO -   2025: 1
2026-02-21 17:28:11,243 - INFO - Published feature branch health audit: feature_branch_health_supervised.csv
2026-02-21 17:28:11,245 - INFO - Published target maturity report: target_maturity_report_supervised.csv
2026-02-21 17:28:11,429 - INFO - Saved training table to /Users/akashc/my-trankcopy/ml model/data/training/unified_training_table_supervised.parquet
2026-02-21 17:28:11,432 - INFO - Saved games-played source mix audit to /Users/akashc/my-trankcopy/ml model/data/audit/games_played_source_mix_by_season.csv
2026-02-21 17:28:11,433 - INFO - Saved minutes source mix audit to /Users/akashc/my-trankcopy/ml model/data/audit/minutes_source_mix_by_season.csv
2026-02-21 17:28:11,434 - INFO - Contract report saved: /Users/akashc/my-trankcopy/ml model/data/audit/surface_grain_contract_report_supervised.json
2026-02-21 17:28:11,434 - INFO - 
============================================================
2026-02-21 17:28:11,434 - INFO - UNIFIED TRAINING TABLE (SUPERVISED) COMPLETE
2026-02-21 17:28:11,434 - INFO - ============================================================
2026-02-21 17:28:11,434 - INFO - Rows: 1,076
2026-02-21 17:28:11,434 - INFO - Columns: 606
